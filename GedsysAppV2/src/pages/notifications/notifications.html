<!--
  Generated template for the NotificationsPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
    <ion-navbar color="primary">
        <button ion-button menuToggle>
            <ion-icon name="menu"></ion-icon>
        </button>
        <ion-title>{{index ? 'Archived' : 'Notifications'}}</ion-title>
    </ion-navbar>
</ion-header>
<ion-content>
    <ion-toolbar *ngIf="ammount > 0" color="primary">
        <ion-searchbar (ionInput)="filter($event)"></ion-searchbar>
    </ion-toolbar>
    <ion-refresher (ionRefresh)="refresh($event)">
        <ion-refresher-content
                pullingIcon="arrow-dropdown"
                pullingText="Pull to refresh"
                refreshingText="Refreshing...">
        </ion-refresher-content>
    </ion-refresher>
    <ion-list no-lines no-border>
        <ion-item-divider color="primary" *ngIf="filterStr.title">Search for: {{filterStr.title}}</ion-item-divider>
        <ion-item *ngIf="ammount == 0">{{index ? "No archived notifications" : "No pending notifications"}}</ion-item>
        <ng-container *ngFor="let notification of user.notifications | filterBy: filterStr | orderBy: 'date.max'; let i = index">
            <ion-item-sliding *ngIf="index == 0 && !notification.archived">
                <ion-item (click)="loadNotificationDetail(notification)">
                    {{notification.title}} <ion-badge [color]="checkColor(notification)" item-end>{{notification.date.max | moment}}</ion-badge>
                </ion-item>
                <ion-item-options side="right" (ionSwipe)="archive(notification)">
                    <button color="danger" ion-button (click)="remove(notification)">Delete</button>
                    <button ion-button expandable (click)="archive(notification)">Archive</button>
                </ion-item-options>
            </ion-item-sliding>
        </ng-container>
        <ng-container *ngFor="let notification of user.notifications | filterBy: filterStr | orderBy: 'date.max'">
            <ion-item-sliding *ngIf="index == 1 && notification.archived">
                <ion-item (click)="loadNotificationDetail(notification)">
                    {{notification.title}} <ion-badge [color]="checkColor(notification)" item-end>{{notification.date.max | moment}}</ion-badge>
                </ion-item>
                <ion-item-options side="right" (ionSwipe)="archive(notification)">
                    <button color="danger" ion-button (click)="remove(notification)">Delete</button>
                    <button ion-button expandable (click)="archive(notification)">Unarchive</button>
                </ion-item-options>
            </ion-item-sliding>
        </ng-container>
    </ion-list>
</ion-content>
